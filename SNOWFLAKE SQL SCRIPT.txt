SELECT
  *
FROM
  "BRIGHTLEARNCOFFESHOP"."PUBLIC"."COFFEESALES"
LIMIT
  10;

  SELECT
    TRANSACTION_ID,
    PRODUCT_CATEGORY,
    PRODUCT_TYPE,
    TRANSACTION_TIME,
    STORE_LOCATION,
    STORE_ID,
    TO_CHAR(DATE_TRUNC('MINUTE', DATEADD(
    MINUTE,
    FLOOR(DATE_PART('MINUTE', TRANSACTION_TIME) / 30) * 30 - DATE_PART('MINUTE', 
    TRANSACTION_TIME),
    TRANSACTION_TIME)), 'HH24:MI') AS TRANSACTION_TIME_BUCKET,
    TO_CHAR(REPLACE(TRANSACTION_DATE, '/', '-')) AS converted_date,
    PRODUCT_TYPE,
    PRODUCT_DETAIL,
    TRANSACTION_QTY,
    REPLACE(UNIT_PRICE, ',', '.') * TRANSACTION_QTY AS TOTAL_AMOUNT,
    REPLACE(UNIT_PRICE, ',', '.') AS UNIT_PRICE,
    COUNT(TRANSACTION_ID) AS NUMBER_OF_TRANSACTIONS,
    COUNT(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCT_SOLD,
    SUM(TRANSACTION_QTY) AS TOTAL_UNITS_SOLD,
    SUM(TO_NUMBER(REPLACE(CAST(UNIT_PRICE AS STRING), ',', '.')) * TRANSACTION_QTY) AS              TOTAL_REVENUE,
    TRANSACTION_DATE,    
    CASE
     WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:59' THEN 'MORNING'
     WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '17:59:59'  THEN 'AFTERNOON'
     WHEN TRANSACTION_TIME BETWEEN '18:00:00' AND '19:59:59' THEN 'EVENING'
  ELSE 'NIGHT'
  END AS TIME_BUCKET, 
   
    FROM
    "BRIGHTLEARNCOFFESHOP"."PUBLIC"."COFFEESALES"
    
     GROUP BY ALL;